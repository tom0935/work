@{
    Layout = null;
}
<script type="text/javascript" src="~/Content/easyui/exts/datagrid-filter.js"></script>
<!--
/* 
合約公司編號 CNO 
公司名稱 CNM
英文名稱 ENM
行業別 RUNTP
CSTTP
來源別 COMETP
客戶等級 CSTLEVL
統一編號 CPID
負責人 CPMGR
公司地址 CPADR
送件地址 SENDADR
電話 TEL
傳真 FAX
EMAIL
 */    
-->
<script type="text/javascript">
     $(document).ready(function () {
         Initialize_DataGrid();
       //  initDataGrid2(null);
     });

     function Initialize_DataGrid() {
         var getGridJSON = '@Url.Action("Grid", "Frm111")';
        $('#cDataGrid').datagrid({
            title: '合約公司維護',
            url: getGridJSON,
            width: '350',
            height: '200',
            rownumbers: true,
            nowrap: true,
            pagination: false,
            pageSize: 20,
            idField: 'CNO',
            striped: true,
            showHeader: true,
            fitColumns: true,
            remoteSort: false,
            singleSelect: true,
            sortName: 'CNO',
            sortOrder: 'asc',
            columns: [[
                {
                    field: 'CNO',
                    title: '公司編號',
                    sortable: true,
                    width: 50,
                    halign: "center",
                    align: "center",
                    sortable: true
                },               
                {
                    field: 'CNM',
                    title: '公司名稱',
                    sortable: true,
                    width: 150,
                    halign: "center",
                    align: "left",
                    sortable: true
                }
            ]],
            onLoadSuccess: function (data) {
                console.info($.trim($('#DEALNO').val()));
                $('#cDataGrid').datagrid('addFilterRule', {
                    field: 'CNO',
                    op: 'contains',
                    value: $.trim($('#DEALNO').val())
                });
                
                $('#cDataGrid').datagrid('selectRow', 0);
            },
            onSelect: function (rowIndex, rowData) {


                $('#cCNO').val($.trim(rowData.CNO));
                $('#cCNM').val($.trim(rowData.CNM));
                $('#cENM').val($.trim(rowData.ENM));                
                
                if (rowData.CSTTP == "1") {
                    $('input[name="cCSTTP"]')[0].checked = true;
                } else {
                    $('input[name="cCSTTP"]')[1].checked = true;
                }
                if (rowData.CSTLEVL == "1") {
                    $('input[name="cCSTLEVL"]')[0].checked = true;
                } else {
                    $('input[name="cCSTLEVL"]')[1].checked = true;
                }

                $('#cCOMETP').combobox('setValue',$.trim(rowData.COMETP));
                $('#cCPADR').val($.trim(rowData.CPADR));
                $('#cSENDADR').val($.trim(rowData.SENDADR));
                $('#cCPMGR').val($.trim(rowData.CPMGR));
                $('#cCPID').val($.trim(rowData.CPID));
                $('#cTEL').val($.trim(rowData.TEL));
                $('#cFAX').val($.trim(rowData.FAX));
                $('#cRUNTP').combobox('setValue',$.trim(rowData.RUNTP));
                $('#cEMAIL').val($.trim(rowData.EMAIL));


                $('#cCNTACT').val($.trim(rowData.CNTACT));
                
                if (rowData.CSTLEVL == "1") {
                    $('input[name="cCSTLEVL"]')[0].checked = true;
                } else {
                    $('input[name="cCSTLEVL"]')[1].checked = true;
                }






                $('#cTAGID').val('');
                $('#dMAN').val('');
                $('#dEMAIL').val('');
                $('#dTEL').val('');
                $('#dNOTES').val('');
                
                initDataGrid2(rowData.CNO);
            }
        });

        $(function () {
            var dg = $('#cDataGrid').datagrid();
            dg.datagrid('enableFilter', [{
                field: 'AA',
                type: 'textbox',
                //options: { precision: 1 },
                op: ['equal', 'notequal', 'less', 'greater']
            }]);
        });

    }


    function initDataGrid2(cno) {
        var obj = {};
        obj.CNO = cno;
        $('#cDataGrid2').datagrid({
            url: '@Url.Action("Grid2", "Frm111")',
            showHeader: true,
            queryParams: obj,
            singleSelect: true,
            width: '310',
            height: '130',
            columns: [[
                {
                    field: 'MAN',
                    title: '姓名',                    
                    width: 150,
                    halign: "center",
                    align: "center"
                },
                {
                    field: 'TEL',
                    title: '電話',
                    width: 150,
                    halign: "center",
                    align: "left"
                }
            ]],
            onSelect: function (rowIndex, row) {                
                $('#cTAGID').val($.trim(row.TAGID));
                $('#dMAN').val($.trim(row.MAN));
                $('#dTEL').val($.trim(row.TEL));
                $('#dEMAIL').val($.trim(row.EMAIL));
                $('#dNOTES').val($.trim(row.NOTES));

            }
        });
    }



    function doClear() {
        $('#cCNO').val('');
        $('#cCNM').val('');
        $('#cCNTACT').val('');
        $('#cTEL').val('');
        $('#cFAX').val('');
        
    }


    




    function doClear2() {
        $('#dMAN').val('');
        $('#dTEL').val('');
        $('#dEMAIL').val('');
        $('#dNOTES').val('');
        $('#TAGID').val('');
    }


    function doCopy() {
        $('#cSENDADR').val($('#cCPADR').val());        
    }

</script>
<!--
<h2>Frm111 合約公司維護</h2>

<a id="btnReload" href="#" class="easyui-linkbutton" data-options="iconCls:'icon-reload'" onclick="Initialize_DataGrid()">重新顯示</a>
<a id="btnAdd" href="#" class="easyui-linkbutton" data-options="iconCls:'add-icon'" onclick="doAdd()">新增</a>
<a id="btnSave" href="#" class="easyui-linkbutton" data-options="iconCls:'save-icon'" onclick="doSave()">儲存</a>
<a id="btnRemove" href="#" class="easyui-linkbutton" data-options="iconCls:'icon-no'" onclick="doRemove()">刪除</a>
 -->
 <table width="900" height="279" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td height="193" colspan="2">
            <strong>合約維護</strong><br />
            <form id="editForm" name="editForm" method="post">

                <table width="100%" border="0" cellpadding="2" cellspacing="0">
                    <tr>
                        <td width="138">合約公司編號</td>
                        <td width="239" align="left"><input type="text" name="cCNO" id="cCNO" class="easyui-validatebox" style="width:80px" size="5" readonly="readonly" /></td>
                        <td width="112">客戶等級</td>
                        <td width="298" align="left">
                            <table width="200" border="0" cellpadding="0" cellspacing="0">
                                <tr>
                                    <td width="67">
                                        <label>
                                            <input name="cCSTLEVL" id="cCSTLEVL" type="radio" value="1" checked="checked" />
                                            一般
                                        </label>

                                    </td>
                                    <td width="133">
                                        <label>
                                            <input name="cCSTLEVL" id="cCSTLEVL" type="radio" value="2" />
                                            重要
                                        </label>
                                    </td>
                                </tr>
                            </table>

                        </td>
                        <td width="84" align="left">負責人</td>
                        <td width="205" align="left"><input type="text" name="cCPMGR" id="cCPMGR" class="easyui-validatebox" style="width:150px" /></td>
                    </tr>
                    <tr>
                        <td>公司名稱</td>
                        <td><input type="text" name="cCNM" id="cCNM" class="easyui-validatebox" style="width:150px" /></td>
                        <td>客戶別</td>
                        <td colspan="3">
                            <table width="200" border="0" cellpadding="0" cellspacing="0">
                                <tr>
                                    <td width="67">
                                        <label>
                                            <input name="cCSTTP" id="cCSTTP" type="radio" value="1" checked="checked" />
                                            個人
                                        </label>
                                        
                                    </td>
                                    <td width="133"><label>
                                             <input name="cCSTTP" id="radio" type="radio" value="2" />
                                             公司
                                        </label>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td>英文名稱</td>
                        <td><input type="text" name="cENM" id="cENM" class="easyui-validatebox" style="width:150px" /></td>
                        <td>公司地址</td>
                        <td colspan="3"><input type="text" name="cCPADR" id="cCPADR" class="easyui-validatebox" style="width:300px" /></td>
                    </tr>
                    <tr>
                        <td>統一編號</td>
                        <td><input type="text" name="cCPID" id="cCPID" class="easyui-validatebox" style="width:150px" /></td>
                        <td>送件地址</td>
                        <td colspan="3"><input type="text" name="cSENDADR" id="cSENDADR" class="easyui-validatebox" style="width:300px" /><a id="btnCopy" href="#" class="easyui-linkbutton" data-options="iconCls:'copy-icon'" onclick="doCopy()">同上</a> </td>
                    </tr>
                    <tr>
                        <td>行業別</td>
                        <td>
                            <select id="cRUNTP" class="easyui-combobox" name="cRUNTP" data-options="editable:false" style="width:150px;">
                                <option>航空運輸</option>
                                <option>食品飲料煙草</option>
                                <option>電子科技半導體</option>
                                <option>百貨零售</option>
                                <option>金融證券</option>
                                <option>國際貿易</option>
                                <option>醫藥生化</option>
                                <option>光電通信/電訊服務</option>
                                <option>保險</option>
                                <option>石化/塑化</option>
                                <option>紡織/造紙</option>
                                <option>外交使節</option>
                                <option>日常生活用品</option>
                                <option>國防軍火</option>
                                <option>顧問服務</option>
                                <option>投資理財</option>
                                <option>汽車相關</option>
                                <option>生態環保</option>
                                <option>農業</option>
                                <option>教育</option>
                                <option>礦業</option>
                                <option>容器包裝</option>
                                <option>媒體</option>
                                <option>其他</option>
                            </select>
                        </td>

                        <td>電話</td>
                        <td><input type="text" name="cTEL" id="cTEL" class="easyui-validatebox" style="width:150px" /></td>
                        <td>傳真</td>
                        <td><input type="text" name="cFAX" id="cFAX" class="easyui-validatebox" style="width:150px" /></td>
                    </tr>
                    <tr>

                        <td>來源別</td>
                        <td>
                            <select id="cCOMETP" class="easyui-combobox" name="cCOMETP" data-options="editable:false" style="width:150px;">
                                <option>仲介</option>
                                <option>福華業務部</option>
                                <option>平面廣告</option>
                                <option>朋友介紹</option>
                                <option>住戶介紹</option>
                                <option>回鍋客</option>
                                <option>網頁</option>
                                <option>特殊管道</option>
                            </select>
                        </td>
                        <td>虛擬帳號</td>
                        <td><input type="text" name="cEMAIL" id="cEMAIL" class="easyui-validatebox" style="width:150px" /></td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                    </tr>
                </table>
            </form>
        </td>
    </tr>
    <tr>
        <td width="300" valign="top"><table id="cDataGrid"></table></td>
        <td width="300" valign="top">
            <input type="hidden" id="mode2" name="mode2" value="save" />
            <input type="hidden" id="cTAGID" name="cTAGID" value="" />
            <strong>聯絡人</strong> 
            姓名<input type="text" name="dMAN" id="dMAN" class="easyui-validatebox" style="width:150px" />
            電話 <input type="text" name="dTEL" id="dTEL" class="easyui-validatebox" style="width:150px" />
            <br>
            EMAIL <input type="text" name="dEMAIL" id="dEMAIL" class="easyui-validatebox" style="width:300px" />
            <br>
            備註<input type="text" name="dNOTES" id="dNOTES" class="easyui-validatebox" style="width:300px" />
            <table id="cDataGrid2"></table>
        </td>
    </tr>
</table>

    
